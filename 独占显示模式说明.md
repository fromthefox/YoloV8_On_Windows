# 🔥 YOLOv8 独占显示模式 - 使用说明

## ✨ 独占显示模式介绍

独占显示模式是一个全新的功能，让您可以专注于当前有检测结果的窗口，而其他窗口将显示为黑屏等待状态。

### 🎯 工作原理
- **当窗口1检测到目标时**: 窗口2和窗口3显示黑屏
- **当窗口2检测到目标时**: 窗口1和窗口3显示黑屏  
- **当窗口3检测到目标时**: 窗口1和窗口2显示黑屏
- **当多个窗口同时检测到目标时**: 按优先级顺序显示（默认: 窗口1 > 窗口2 > 窗口3）
- **当没有任何检测时**: 所有窗口都显示黑屏等待状态

## 🚀 快速启动

### 启用独占模式
```bash
# 方法一：通过配置文件
# 编辑 config.py，设置 exclusive_display = True

# 方法二：运行时切换
# 启动程序后按 'e' 键切换模式
```

### 运行程序
```bash
# 激活环境
conda activate yolo_test

# 启动检测
python yolo_webcam.py

# 或使用演示程序
python demo_multi_window.py
# 选择 "4. 测试独占模式"
```

## ⚙️ 配置设置

### 在 `config.py` 中配置独占模式
```python
# 独占显示设置
exclusive_display = True  # 启用独占显示模式
exclusive_priority = ["window1", "window2", "window3"]  # 优先级顺序
black_screen_text = "No Detection"  # 黑屏时显示的文本
show_waiting_message = True  # 是否在黑屏时显示等待消息
```

### 自定义优先级
```python
# 示例：让窗口3优先级最高
exclusive_priority = ["window3", "window1", "window2"]

# 示例：让窗口2优先级最高
exclusive_priority = ["window2", "window1", "window3"]
```

## 🎮 操作说明

### 基本控制
- **q**: 退出程序
- **s**: 保存所有窗口的当前帧（包括黑屏状态）
- **c**: 清除控制台输出
- **e**: 🔥 **切换独占显示模式** （实时开关）

### 窗口控制
- **1**: 切换到窗口1焦点
- **2**: 切换到窗口2焦点
- **3**: 切换到窗口3焦点

### 状态指示
每个窗口显示：
- **[ACTIVE]**: 当前活跃窗口（有检测结果）
- **[WAITING]**: 等待状态（黑屏）
- **Mode: EXCLUSIVE**: 独占模式
- **Mode: NORMAL**: 普通模式

## 🎯 使用场景

### 1. 专注监控
- 只关注有检测结果的窗口
- 避免多窗口干扰
- 提高注意力集中度

### 2. 演示展示
- 清晰展示不同类别的检测效果
- 避免信息过载
- 突出重点检测结果

### 3. 性能优化
- 减少显示处理
- 专注于有效检测
- 降低视觉负担

## 📊 优先级系统

### 默认优先级
1. **窗口1** (最高优先级): 人物、火车
2. **窗口2** (中等优先级): 手机、杯子、汽车
3. **窗口3** (最低优先级): 电脑、键盘、电视等

### 优先级规则
- 当多个窗口同时检测到目标时，只显示优先级最高的窗口
- 其他窗口显示黑屏等待状态
- 可通过配置文件自定义优先级顺序

### 示例场景
```
情况1: 只有窗口2检测到手机
结果: 窗口2显示检测结果，窗口1和3显示黑屏

情况2: 窗口1检测到人物，窗口3检测到电脑
结果: 窗口1显示检测结果（优先级高），窗口2和3显示黑屏

情况3: 没有任何检测
结果: 所有窗口都显示黑屏等待状态
```

## 🎨 视觉效果

### 活跃窗口
- 显示实际检测图像
- 彩色检测框和标签
- 状态显示为 **[ACTIVE]**
- 信息文字为亮色

### 等待窗口（黑屏）
- 纯黑色背景
- 显示窗口编号和等待信息
- 状态显示为 **[WAITING]**
- 信息文字为暗色
- 显示当前时间

## 🔧 技术实现

### 核心算法
1. **检测分析**: 分析每个窗口的检测结果数量
2. **优先级判断**: 根据配置的优先级顺序确定活跃窗口
3. **画面控制**: 为非活跃窗口生成黑屏图像
4. **状态显示**: 实时更新窗口状态信息

### 关键代码逻辑
```python
def determine_active_window(self, window_results):
    # 按优先级检查哪个窗口有检测结果
    for window_name in EXCLUSIVE_PRIORITY:
        if len(window_results[window_name]["detections"]) > 0:
            return window_name
    return None  # 没有检测结果
```

## 🛠️ 故障排除

### 常见问题

#### 1. 所有窗口都显示黑屏
- **原因**: 没有检测到任何目标
- **解决**: 确保摄像头中有可检测的对象

#### 2. 期望的窗口没有显示
- **原因**: 优先级设置问题
- **解决**: 检查 `config.py` 中的 `exclusive_priority` 设置

#### 3. 无法切换模式
- **原因**: 按键检测问题
- **解决**: 确保窗口处于焦点状态，重新按 'e' 键

#### 4. 黑屏显示异常
- **原因**: 分辨率设置问题
- **解决**: 检查 `frame_width` 和 `frame_height` 设置

### 性能优化
```python
# 对于低配置设备
exclusive_display = True  # 启用独占模式可以提高性能
skip_frames = 1  # 适当跳帧
confidence_threshold = 0.7  # 提高置信度阈值
```

## 📈 进阶使用

### 自定义黑屏显示
```python
# 修改黑屏文本
black_screen_text = "等待检测中..."

# 禁用等待消息（纯黑屏）
show_waiting_message = False
```

### 动态优先级
在程序运行过程中，可以按 'e' 键切换独占模式，实现：
- **EXCLUSIVE模式**: 独占显示
- **NORMAL模式**: 所有窗口正常显示

### 保存功能
按 's' 键保存时：
- **独占模式**: 保存活跃窗口的检测图像 + 其他窗口的黑屏图像
- **普通模式**: 保存所有窗口的检测图像

## 🎊 总结

独占显示模式为YOLOv8三窗口检测系统增加了：

### 功能特点
- ✅ **专注显示**: 只显示有检测结果的窗口
- ✅ **智能优先级**: 多窗口检测时按优先级显示
- ✅ **实时切换**: 按 'e' 键实时切换模式
- ✅ **视觉清晰**: 活跃窗口突出显示，等待窗口黑屏
- ✅ **完全可配置**: 支持自定义优先级和显示设置

### 应用价值
- 🎯 **提高专注度**: 避免多窗口信息干扰
- 📊 **优化展示**: 演示时更加专业和清晰
- ⚡ **性能提升**: 减少不必要的显示处理
- 🎮 **用户友好**: 简单的按键操作，直观的状态显示

**现在您可以享受更加专注和高效的目标检测体验！** 🎉

---

## 🔗 相关文档
- [三窗口使用说明.md](三窗口使用说明.md) - 基础三窗口功能
- [项目说明.md](项目说明.md) - 项目总体介绍
- [config.py](config.py) - 配置文件说明
